```html
{% extends "billing/base.html" %}
{% block content %}
<h1>Scan Meter & Capture Reading</h1>

<div class="row">
  <div class="col-md-6">
    <h5>QR Scanner</h5>
    <!-- html5-qrcode will insert camera preview here -->
    <div id="qr-reader" style="width:100%"></div>
    <div class="mt-2">
      <small class="text-muted">QR should contain the meter ID (e.g. meter:12345 or just 12345)</small>
    </div>
    <div class="mt-3">
      <label class="form-label">Detected meter ID</label>
      <input id="meter-id" class="form-control" readonly>
    </div>
  </div>

  <div class="col-md-6">
    <h5>Capture Photo & OCR</h5>
    <video id="camera-stream" autoplay playsinline style="width:100%; max-height:360px; background:#000"></video>
    <canvas id="capture-canvas" style="display:none;"></canvas>
    <div class="mt-2">
      <button id="btn-capture" class="btn btn-primary">Capture photo</button>
      <button id="btn-ocr" class="btn btn-outline-secondary">Run OCR</button>
    </div>

    <div class="mt-3">
      <label class="form-label">OCR result</label>
      <textarea id="ocr-text" class="form-control" rows="3"></textarea>
    </div>

    <div class="mt-3">
      <label class="form-label">Confirmed reading</label>
      <input id="reading-value" class="form-control" placeholder="e.g. 1234.56">
    </div>

    <div class="mt-3">
      <button id="btn-submit" class="btn btn-success">Submit Reading</button>
    </div>
  </div>
</div>

<script src="https://unpkg.com/html5-qrcode@2.3.8/minified/html5-qrcode.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.1.5/dist/tesseract.min.js"></script>
<script>
/* Basic client-side flow:
 - html5-qrcode scans QR and writes meter id to #meter-id
 - Use getUserMedia, show in video#camera-stream, capture into canvas, convert to blob
 - Run Tesseract.recognize on the captured image to populate #ocr-text
 - Submit via fetch multipart/form-data to /billing/api/upload-reading/
*/
</script>
<script src="{% static 'billing/js/scan.js' %}"></script>
{% endblock %}